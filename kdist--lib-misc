#! /bin/bash

# This can be used either for project or kernel releases. In the
# kernel case, the parent of v3.4.4-1 is v3.4.4, that is the function
# returns a release that was not done by kdist.
release__get_parent () {
	git describe --match=v[[:digit:]].[[:digit:]]\* \
		--abbrev=0 ${1:-HEAD}~1
}

module__list () {
	git submodule foreach -q 'echo $name'
}

# Given a release, return a module sha1 used to create that release.
module__get_sha1 () {
	local line=$(git ls-tree $1 -- $2) &&
	read mode type sha1 unused <<<$line &&
	echo $sha1
}
